## 목차
### 1. 연습문제 | 전화번호부에 메세지 기능 추가
### 2. DataStorage | 데이터 영구저장
<br/><br/>

# 1. 연습문제 | 전화번호부에 메세지 기능 추가
### Receiver Test 프로젝트 (메세지 기능) 

> manifest.xml
- 수정된 부분 | 묵시적 호출을 위한 intent filter 추가
```xml
        <activity android:name=".SMSActivity" >
            <intent-filter>
                <action android:name="com.example.receivertest.sms_send"></action>
            </intent-filter>
        </activity>
```  
- 묵시적으로 활성화할 컴포넌트 설정.<br/>
        이 이름으로 지정된 인텐트 필터가 날아온다면 해당화면으로 넘어오게 조건을 지정한다.
- 패키지 이름까지 안넣어줘도 상관 없음.<br/>
하지만 중복 방지를 위해서 안전하게 넣어줌

> SMSActivity.java

- 수정된 부분
```java
@Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_s_m_s);
        msg_et = findViewById(R.id.msg);
        phone_et = findViewById(R.id.phone);

        Intent intent = getIntent();
        String tel = intent.getStringExtra("tel");
        if(tel!=null && ! tel.equals("")){
            phone_et.setText(tel);
        }
    }
```
<details>
<summary>SMSActivity 전체코드 보기 </summary>
        
```java
package com.example.receivertest;

import androidx.appcompat.app.AppCompatActivity;
import androidx.core.app.ActivityCompat;
import androidx.core.content.ContextCompat;

import android.Manifest;
import android.app.Activity;
import android.app.AlertDialog;
import android.app.PendingIntent;
import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.DialogInterface;
import android.content.Intent;
import android.content.IntentFilter;
import android.content.pm.PackageManager;
import android.os.Build;
import android.os.Bundle;
import android.telephony.SmsManager;
import android.telephony.SmsMessage;
import android.view.View;
import android.widget.EditText;
import android.widget.Toast;

public class SMSActivity extends AppCompatActivity {
    private EditText msg_et;
    private EditText phone_et;

    //각 리시버를 깨울 상수값
    private final static String SEND_ACTION = "SENT";
    private final static String DELIVER_ACTION = "DELIVERED";

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_s_m_s);
        msg_et = findViewById(R.id.msg);
        phone_et = findViewById(R.id.phone);

        Intent intent = getIntent();
        String tel = intent.getStringExtra("tel");
        if(tel!=null && ! tel.equals("")){
            phone_et.setText(tel);
        }
    }

    public void onSend(View view){
        String msg = msg_et.getText().toString();
        String phone = phone_et.getText().toString();

        // 둘 중 하나라도 내용이 없다면, 내용입력 받게끔 설정
        if(msg.length() <=0 || phone.length() <=0){
            Toast.makeText(getApplicationContext(),
                    "input the message and phone number!",
                    Toast.LENGTH_SHORT).show();
            return;
        }

        //sms 보내는 쪽 상태확인을 위한 객체
        PendingIntent sendStat = PendingIntent.getBroadcast(this,0,
                new Intent("SENT"),0);// context, 확인 코드, 리시버를 깨울 인텐트, flag
        //sms 받는 쪽 상태확인을 위한 객체
        PendingIntent deliveredStat = PendingIntent.getBroadcast(this,0,
                new Intent("DELIVERED"),0);

        SmsManager sms = SmsManager.getDefault();

        //sms 전송
        sms.sendTextMessage(phone, null, msg, sendStat, deliveredStat);
        setResult(RESULT_OK);//보낼 데이터가 없다면 intent 보내지 않음.
        finish();//현재 activity 종료.
    }
}
```

</details>

### PhoneBook 프로젝트 (전화번호부 기능)
> phoneAdapter.java
- sms 버튼을 누르면 동작할 이벤트 함수 추가
- 추가된 부분
```java
sms.setOnClickListener(new View.OnClickListener() {
                @Override
                public void onClick(View view) {
                    //다른 액티비티에 있는 프로그램을 호출하기 위해,
                    //해당 프로그램의 이름과 해당 액티비티 클래스이름을 알려줘야 함.
                    ComponentName cn = new ComponentName("com.example.receivertest","com.example.receivertest.SMSActivity");
                    Intent intent = new Intent("com.example.receivertest.sms_send");//action 이름 설정
                    intent.putExtra("tel",m.getTel());
                    intent.setComponent(cn);
                    context.startActivity(intent);
                }
            });
```

<details>
<summary> phoneAdapter 전체코드 보기 </summary>

```java
package com.example.phonebook;

import android.content.ComponentName;
import android.content.Context;
import android.content.Intent;
import android.net.Uri;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.ArrayAdapter;
import android.widget.Button;
import android.widget.ImageView;
import android.widget.TextView;

import androidx.annotation.NonNull;
import androidx.annotation.Nullable;

import com.example.phonebook.model.Member;

import java.util.ArrayList;
import java.util.List;

public class phoneAdapter extends ArrayAdapter<Member> {
    private Context context;
    private ArrayList<Member> list;
    private int resId;

    public phoneAdapter(@NonNull Context context, int resource, @NonNull List<Member> objects) {
        super(context, resource, objects);
        this.context = context;
        this.list = (ArrayList<Member>) objects;
        resId = resource;
    }

    @NonNull
    @Override
    //getview: 어댑터에서 가장 중요한 작업! 데이터 위치(position)를 읽어와서 리소스로 지정한 뷰로 생성하여 반환
    //list의 요소개수만큼 호출되는 함수
    public View getView(int position, @Nullable View convertView, @NonNull ViewGroup parent) {
        View itemView = convertView;
        if(itemView==null){            //뷰가 없다면 생성
            LayoutInflater vi = (LayoutInflater) context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);//LayoutInflater: xml등의 리소스를 실제 뷰로 부풀리는 역할을 하는 객체
            itemView = vi.inflate(resId,null);//설계한 자료의 id를 받아서 해당 id로 실제 뷰를 생성.(item_layout.xml)
        }
        final Member m = list.get(position);//현재 위치의 멤버 객체 추출
        if(m != null) {
            TextView t1 = itemView.findViewById(R.id.textView);//이름 tv
            TextView t2 = itemView.findViewById(R.id.textView2);//전화번호 tv
            ImageView imgv = itemView.findViewById(R.id.imageView);//이미지
//            imgv.setImageResource(R.drawable.ic_launcher_foreground);//임시로 고정값 사용.

            Button sms = itemView.findViewById(R.id.button17);
            Button call = itemView.findViewById(R.id.button19);

            //뷰에 텍스트 세팅
            if(t1!=null){
                t1.setText(m.getName());
            }
            if(t2!=null){
                t2.setText(m.getTel());
            }
            if(imgv!=null){
                imgv.setImageResource(m.getImgRes());
            }

            call.setOnClickListener(new View.OnClickListener() {
                @Override
                public void onClick(View view) {
                    //action_call: 시스템에서 제공하는 것이기 때문에 permission 설정 필요 => manifestAndroid
                    Intent intent = new Intent(Intent.ACTION_DIAL, Uri.parse("tel:"+m.getTel()));//묵시적으로 activity 활성화
                    context.startActivity(intent);
                }
            });

            sms.setOnClickListener(new View.OnClickListener() {
                @Override
                public void onClick(View view) {
                    //다른 액티비티에 있는 프로그램을 호출하기 위해,
                    //해당 프로그램의 이름과 해당 액티비티 클래스이름을 알려줘야 함.
                    ComponentName cn = new ComponentName("com.example.receivertest","com.example.receivertest.SMSActivity");
                    Intent intent = new Intent("com.example.receivertest.sms_send");//action 이름 설정
                    intent.putExtra("tel",m.getTel());
                    context.startActivity(intent);
                }
            });
        }
        return itemView;
    }
}

```

</detail>

# 2. DataStorage | 데이터 영구저장 p.168

## 개념 | DataStorage와 preferences 파일 

> preferences

> preference API
- getshared : 파일명 지정해서 오 픈
- get 
- mode: 다른이 오픈 가능하게 할 것인지 

## 실습 | Storage test 프로젝트

> activity_main.xml

> MainActivity.java


